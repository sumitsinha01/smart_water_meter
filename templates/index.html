{% extends "layout.html" %}
{% block body %}
<header>
    <div class="container">
        {% if current_user.is_authenticated %}
        <div class="intro-text">
        <div class="">Smart Water Meter</div>
        <div class="intro-heading">Welcome {{ current_user.name }}</div>
        <div class="">This month water usage: </div>
        </div>
        {% endif %}
    </div>
        </header>

    <div id="top_x_div" style="width: 900px; height: 500px;">
        <script type="text/javascript">
        google.charts.load('current', {'packages':['bar']});
        google.charts.setOnLoadCallback(drawStuff);

        var monthNames = ["January", "February", "March", "April", "May", "June",
                            "July", "August", "September", "October", "November", "December"
                           ];

        function drawStuff() {
            var data = new google.visualization.arrayToDataTable([
            ['Month', 'Volume'],

        {% if current_user.is_authenticated %}
        {% for month,vol in usage.items(): %}
        [monthNames[{{month}}-1],{{vol}}],
        {% endfor %}
        {% endif %}
        ]);

        console.log("-------");
        console.log(data);
                console.log("-------");



        var options = {
            title: 'Water used in liters',
            width: 900,
            legend: { position: 'none' },
            chart: { title: 'Water consumption',
                     subtitle: 'Usage in liters' },
            bars: 'horizontal', // Required for Material Bar Charts.
            axes: {
                x: {
                    0: { side: 'top', label: 'Volume in Liters'} // Top x-axis.
                }
            },
            bar: { groupWidth: "90%" }
        };

        var chart = new google.charts.Bar(document.getElementById('top_x_div'));
        chart.draw(data, options);
        };
        </script>
    </div>

{% endblock %}